<!DOCTYPE html>
<html lang="cs-cz">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="Roman Ožana">
	<title>How to safely commit vendor dir with php Composer</title>	
	<meta name="twitter:card" content="summary"/>
	<meta name="twitter:title" content="How to safely commit vendor dir with php Composer"/>
	<meta name="twitter:description" content="How to safely commit vendor dir with php Composer Composer is great tool, but sometimes you will need avoid all external dependencies. Sometimes you will need have all source codes in your git repository. Should I commit the dependencies in my vendor directory, and still have all benefits of using Composer? Here are my requirements: - Everything need to be automatically. - I will work on application and my packages together."/>
	<meta name="twitter:site" content="@OzzyCzech"/>
	<meta name="twitter:domain" content="http://blog.omdesign.cz/"/>
	<meta name="twitter:creator" content="@OzzyCzech"/>
	<meta property="og:title" content="How to safely commit vendor dir with php Composer" />
	<meta property="og:description" content="How to safely commit vendor dir with php Composer Composer is great tool, but sometimes you will need avoid all external dependencies. Sometimes you will need have all source codes in your git repository. Should I commit the dependencies in my vendor directory, and still have all benefits of using Composer? Here are my requirements: - Everything need to be automatically. - I will work on application and my packages together." />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="http://blog.omdesign.cz/how-to-safely-commit-vendor-dir-with-php-composer/" />
	<meta property="og:updated_time" content="2013-07-24 00:00:00 &#43;0000 UTC"/>
	<meta property="og:site_name" content="blog.omdesign.cz" />
	<meta property="article:author" content="https://www.facebook.com/roman.ozana" />
	<meta property="article:publisher" content="https://www.facebook.com/roman.ozana" />
	<meta property="article:published_time" content="0001-01-01 00:00:00 &#43;0000 UTC" />
	<meta property="article:modified_time" content="2013-07-24 00:00:00 &#43;0000 UTC" />
	<meta property="article:section" content="posts" />
	<meta property="article:tag" content="composer" />
	<meta property="article:tag" content="git" />
	<meta property="article:tag" content="PHP" />
	<meta itemprop="name" content="How to safely commit vendor dir with php Composer">
	<meta itemprop="description" content="How to safely commit vendor dir with php Composer Composer is great tool, but sometimes you will need avoid all external dependencies. Sometimes you will need have all source codes in your git repository. Should I commit the dependencies in my vendor directory, and still have all benefits of using Composer? Here are my requirements: - Everything need to be automatically. - I will work on application and my packages together.">
	<meta itemprop="keywords" content="ajax,angular,antispam,archive,atom,auto,automator,barvy,bash,boostrap,brew,canvas,composer,css,diplomka,drive,email,excerpt,ftp,git,github,gulp,hack,hash,heartbleed,hermelín,how-to,howto,html,html5,internet,ios,iphone,js,json,lifehacker,mac,meta,movies,nodejs,npm,oauth,oko,openssl,osx,parkinsons-law,pear,php,plugin,protip,přepis-auta,rebase,recepty,retina,shell,student,svg,terminal,tip,todo,tyčinky,user,ux,webdesign,wordpress,wysiwyg,xcode,youtube,zamyšlení,zdraví,zip," />
	<meta itemprop="wordCount" content="308">
<!-- Fonts, jQuery and js -->
	<link href="//fonts.googleapis.com/css?family=Lora" rel="stylesheet">
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
	<script src="http://blog.omdesign.cz//js/app.js"></script>
	<!-- Twitter boostrap -->
	<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
	<script src="//netdna.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"
	      integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
	<!-- Google code prettify -->
	<script src="//cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?autoload=true"></script>
	<link href="http://blog.omdesign.cz//css/style.css" rel="stylesheet">
</head>
<body>


<section class="container">
	<article>
	

<h1 id="how-to-safely-commit-vendor-dir-with-php-composer">How to safely commit vendor dir with php Composer</h1>

<p><a href="http://getcomposer.org/">Composer</a> is great tool, but sometimes you will need avoid all external dependencies. Sometimes you will need have all source codes in your git repository. Should I <a href="http://getcomposer.org/doc/faqs/should-i-commit-the-dependencies-in-my-vendor-directory.md"> commit the dependencies</a> in my vendor directory, and still have all benefits of using Composer? Here are my requirements: - Everything need to be automatically.
- I will work on application and my packages together.
- I need a simple way how to commit and publish new version of packages.
- Workflow need to be simple (mimimum of commands)</p>

<h3 id="how-to-commit-vendor-dir">How to commit vendor dir?</h3>

<p>Remove <code>vendor</code> dir from your <code>.gitignore</code> and add follow lines to root of <code>composer.json</code></p>

<pre><code>&quot;scripts&quot;: {
 &quot;post-update-cmd&quot;: [&quot;echo [WARNING] Delete all .git dirs&quot;, &quot;rm -rf vendor/**/**/.git&quot;],
 &quot;post-install-cmd&quot;: [&quot;echo [WARNING] Delete all .git dirs&quot;, &quot;rm -rf vendor/**/**/.git&quot;]
},
</code></pre>

<p>That&rsquo;s automatically remove the <code>.git</code> directory of every dependency after the installation or update. You can safely commit everything to your git repo and avoid mistakes with fake git &ldquo;submodules&rdquo;. Run: <code>composer update</code> and commit everything to your repo. ### How make changes in packages?</p>

<p>When you are using tagged releases (no dev versions) of package then run:</p>

<pre><code>rm -rf vendor/some/package &amp;&amp; composer update some/package --prefer-source --no-scripts
</code></pre>

<p>For dev versions (dev-master) it&rsquo;s simpler:</p>

<pre><code>rm -rf vendor/some/package &amp;&amp; composer update some/package --no-scripts
</code></pre>

<p>Now, when you go to vendor/some/package dir it&rsquo;s common git repository - you can make changes, commit and publish new versions of package. But don&rsquo;t forgot run <code>composer update</code> before commit main repo, becouse there is still .git dir in package! ### Disadvantages</p>

<ul>
<li>Large VCS repository size and diffs when you update code.</li>
<li>Duplication of the history of all your dependencies in your own VCS.</li>
<li>There can be conflicts in commits especially when you work in larger team.</li>
<li>Still <strong>not avoid commit .git directory</strong> after running composer with <code>--no-scripts</code> param.</li>
</ul>

	
	<a href="http://blog.omdesign.cz/tags/composer">#composer</a>
	
	<a href="http://blog.omdesign.cz/tags/git">#git</a>
	
	<a href="http://blog.omdesign.cz/tags/php">#PHP</a>
	
	<time datetime="24076-08-724 240:00&#43;0000">24. 7. 2013</time>
</article>

</section>

<div class="text-center">
	<a href="http://blog.omdesign.cz/" class="btn btn-primary btn-lg" onclick="history.go(-1);"><i class="glyphicon glyphicon-chevron-left"></i>
		Go back</a>
</div>


    <footer></footer>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-5420131-1', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>

