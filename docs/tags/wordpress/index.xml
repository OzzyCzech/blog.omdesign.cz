<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Wordpress on blog.omdesign.cz</title>
    <link>http://blog.omdesign.cz/tags/wordpress/</link>
    <description>Recent content in Wordpress on blog.omdesign.cz</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>cs-cz</language>
    <managingEditor>ozana@omdesign.cz (Roman Ožana)</managingEditor>
    <webMaster>ozana@omdesign.cz (Roman Ožana)</webMaster>
    <lastBuildDate>Thu, 24 Jul 2014 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://blog.omdesign.cz/tags/wordpress/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>How to add all custom post type to main Wordpress archive.php</title>
      <link>http://blog.omdesign.cz/how-to-add-all-custom-post-type-to-main-wordpress-archive.php/</link>
      <pubDate>Thu, 24 Jul 2014 00:00:00 +0000</pubDate>
      <author>ozana@omdesign.cz (Roman Ožana)</author>
      <guid>http://blog.omdesign.cz/how-to-add-all-custom-post-type-to-main-wordpress-archive.php/</guid>
      <description>

&lt;h1 id=&#34;how-to-add-all-custom-post-type-to-main-wordpress-archive-php&#34;&gt;How to add all custom post type to main Wordpress archive.php&lt;/h1&gt;

&lt;p&gt;Default archive shows only &lt;code&gt;post&lt;/code&gt; type if you need show all post types just add follow code to &lt;code&gt;function.php&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;add_filter(
&#39;pre_get_posts&#39;, function ($query) {
        if (
            $query-&amp;gt;is_main_query() &amp;amp;&amp;amp;
            !is_admin() &amp;amp;&amp;amp;
            (is_category() || is_tag())
            &amp;amp;&amp;amp; empty($query-&amp;gt;query_vars[&#39;suppress_filters&#39;])
        ) {
            $posts = array_diff(
                get_post_types([&#39;public&#39; =&amp;gt; true]), [&#39;page&#39;, &#39;attachment&#39;, &#39;revision&#39;, &#39;forum&#39;, &#39;reply&#39;, &#39;topic&#39;] /* array of ignored types*/
            );
            $query-&amp;gt;set(
                &#39;post_type&#39;, $posts
            );
            return $query;
        }
    }
);
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Wordpress -  get post excerpt</title>
      <link>http://blog.omdesign.cz/wordpress/wordpress-get-post-excerpt/</link>
      <pubDate>Mon, 02 Dec 2013 00:00:00 +0000</pubDate>
      <author>ozana@omdesign.cz (Roman Ožana)</author>
      <guid>http://blog.omdesign.cz/wordpress/wordpress-get-post-excerpt/</guid>
      <description>

&lt;h1 id=&#34;wordpress-get-post-excerpt&#34;&gt;Wordpress: get post excerpt&lt;/h1&gt;

&lt;p&gt;&lt;code&gt;$excerpt = apply_filters(&#39;the_excerpt&#39;, get_post_field(&#39;post_excerpt&#39;, $post_id));&lt;/code&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Wordpress - How to get user by metadata</title>
      <link>http://blog.omdesign.cz/wordpress/wordpress-how-to-get-user-by-metadata/</link>
      <pubDate>Tue, 16 Apr 2013 00:00:00 +0000</pubDate>
      <author>ozana@omdesign.cz (Roman Ožana)</author>
      <guid>http://blog.omdesign.cz/wordpress/wordpress-how-to-get-user-by-metadata/</guid>
      <description>

&lt;h1 id=&#34;wordpress-how-to-get-user-by-metadata&#34;&gt;Wordpress - How to get user by metadata&lt;/h1&gt;

&lt;p&gt;Getting user by field name is easy, #Wordpress have function for that &lt;a href=&#34;http://codex.wordpress.org/Function_Reference/get_user_by&#34;&gt;get_user_by&lt;/a&gt;. Getting user by his metadata is a little bit complicated. You can found on the Internet some complex procedures how to &lt;strong&gt;get user by metadata&lt;/strong&gt; using &lt;a href=&#34;https://codex.wordpress.org/Class_Reference/WP_Query&#34;&gt;WP_Query&lt;/a&gt; object. Forget about them! You need prepare correct meta query as array or string and call &lt;code&gt;get_users&lt;/code&gt;. Thats all!&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/**
 * Get user by his metadata
 * @author Roman Ozana &amp;lt;ozana@omdesign.cz&amp;gt;
 * @param $meta_key
 * @param $meta_value
 * @return mixed
 */
function get_user_by_meta($meta_key, $meta_value) {
 return reset(
  get_users(
   array(
    &#39;meta_key&#39; =&amp;gt; $meta_key,
    &#39;meta_value&#39; =&amp;gt; $meta_value,
    &#39;number&#39; =&amp;gt; 1,
    &#39;count_total&#39; =&amp;gt; false
   )
  )
 );
}
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Wodpress constants for human-readable intervals</title>
      <link>http://blog.omdesign.cz/wordpress/wodpress-constants-for-human-readable-intervals/</link>
      <pubDate>Wed, 20 Feb 2013 00:00:00 +0000</pubDate>
      <author>ozana@omdesign.cz (Roman Ožana)</author>
      <guid>http://blog.omdesign.cz/wordpress/wodpress-constants-for-human-readable-intervals/</guid>
      <description>

&lt;h1 id=&#34;wodpress-constants-for-human-readable-intervals&#34;&gt;Wodpress constants for human-readable intervals&lt;/h1&gt;

&lt;p&gt;Constants for expressing human-readable intervals in new #Wordpress are very useful:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;define( &#39;MINUTE_IN_SECONDS&#39;, 60 );
define( &#39;HOUR_IN_SECONDS&#39;,   60 * MINUTE_IN_SECONDS );
define( &#39;DAY_IN_SECONDS&#39;,    24 * HOUR_IN_SECONDS   );
define( &#39;WEEK_IN_SECONDS&#39;,    7 * DAY_IN_SECONDS    );
define( &#39;YEAR_IN_SECONDS&#39;,  365 * DAY_IN_SECONDS    );
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;wp_cache_add($key, $data, &#39;default, 5 * DAY_IN_SECONDS);
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Make WordPress globals more accessible</title>
      <link>http://blog.omdesign.cz/wordpress/make-wordpress-globals-more-accessible/</link>
      <pubDate>Fri, 08 Feb 2013 00:00:00 +0000</pubDate>
      <author>ozana@omdesign.cz (Roman Ožana)</author>
      <guid>http://blog.omdesign.cz/wordpress/make-wordpress-globals-more-accessible/</guid>
      <description>

&lt;h1 id=&#34;make-wordpress-globals-more-accessible&#34;&gt;Make WordPress globals more accessible&lt;/h1&gt;

&lt;p&gt;Wordpress using a lot &lt;a href=&#34;http://codex.wordpress.org/Global_Variables&#34;&gt;globals variables&lt;/a&gt;. These variables are used throughout WordPress code for various reasons. Great example is database connection object &lt;a href=&#34;http://codex.wordpress.org/Class_Reference/wpdb&#34;&gt;wpdb&lt;/a&gt;. Here is common example how to use &lt;strong&gt;wpdb&lt;/strong&gt; in some function:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;function something() {
  global $wpdb;
  /** @var wpdb $wpdb */
  $wpdb-&amp;gt;query(&#39;SQL...&#39;);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It&amp;rsquo;s highly uncomfortable and long! Therefore, I have prepared a simple object which make all global variables much more accesible from anywhere: &lt;a href=&#34;https://gist.github.com/OzzyCzech/4737518&#34;&gt;https://gist.github.com/OzzyCzech/4737518&lt;/a&gt; (PHP 5.3+ only)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;function something() {
  Globals::wpdb()-&amp;gt;query(&#39;SQL...&#39;);
}
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Wordpress - register and setup widgets from PHP code</title>
      <link>http://blog.omdesign.cz/wordpress/wordpress-register-and-setup-witgets-from-php-code/</link>
      <pubDate>Tue, 29 Jan 2013 00:00:00 +0000</pubDate>
      <author>ozana@omdesign.cz (Roman Ožana)</author>
      <guid>http://blog.omdesign.cz/wordpress/wordpress-register-and-setup-witgets-from-php-code/</guid>
      <description>

&lt;h1 id=&#34;wordpress-register-and-setup-witgets-from-php-code&#34;&gt;Wordpress: register and setup witgets from PHP code&lt;/h1&gt;

&lt;p&gt;PHP driven registration of the #Widgets in #Wordpress can be quite confusing. There is my way how to handle it:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;class Widgets {

 private $widgets = array();
 private $options = array();

 public function __construct() {
  $this-&amp;gt;options = wp_get_sidebars_widgets();
 }

 public function unregisterAllWidgets() {
  foreach ($this-&amp;gt;options as $name =&amp;gt; $values)
   $this-&amp;gt;options[$name] = array();
 }

 public function cleanWidgetSettings($type, $multi = null) {
  $this-&amp;gt;widgets[$type] = array();
  if ($multi !== null) $this-&amp;gt;widgets[$type][&#39;_multiwidget&#39;] = (int)(bool)$multi;
 }

 public function setMultiWidget($type, $val = 1) {
  $this-&amp;gt;widgets[$type][&#39;_multiwidget&#39;] = $val;
 }

 public function add($type, array $options, $area = null) {
  $this-&amp;gt;widgets[$type][] = $options;
  if ($area !== null) {
   if (array_key_exists($area, $this-&amp;gt;options) === false) {
    throw new Exception(&#39;Widget area &#39; . $area . &#39; not exists.&#39;);
   }
   end($this-&amp;gt;widgets[$type]);
   $this-&amp;gt;options[$area][] = $type . &#39;-&#39; . key($this-&amp;gt;widgets[$type]);
  }
 }

 public function __destruct() {
  foreach ($this-&amp;gt;widgets as $name =&amp;gt; $settings) {
   if (!array_key_exists(&#39;_multiwidget&#39;, $settings)) $settings[&#39;_multiwidget&#39;] = 1;
   update_option(&#39;widget_&#39; . $name, $settings);
  }
  wp_set_sidebars_widgets($this-&amp;gt;options);
 }

}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Following code is an example how to use &lt;code&gt;class Witgets&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$widgets = new Widgets();
$widgets-&amp;gt;unregisterAllWidgets();

$widgets-&amp;gt;add(
 &#39;text&#39;,
 array(
  &#39;title&#39; =&amp;gt; &#39;About us&#39;,
  &#39;text&#39; =&amp;gt; &#39;Simple text about us&#39;,
  &#39;filter&#39; =&amp;gt; true,
  &#39;classes&#39; =&amp;gt; &#39;&#39;,
  &#39;ids&#39; =&amp;gt; null,
 ),
 &#39;footer-1&#39;
);

// ...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This code need to be call only once. Put your code to &lt;code&gt;function.php&lt;/code&gt; to &lt;code&gt;after_switch_theme&lt;/code&gt; action:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;add_action(
 &#39;after_switch_theme&#39;, function () {
  $widgets = new Widgets();
  $widgets-&amp;gt;unregisterAllWidgets();
  // ...
 }
);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a href=&#34;https://gist.github.com/4663766/&#34;&gt;https://gist.github.com/4663766/&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>WYSIWYG pro popis uživatele ve Wordpress</title>
      <link>http://blog.omdesign.cz/wysiwyg-pro-popis-u%C5%BEivatele-ve-wordpress/</link>
      <pubDate>Mon, 29 Oct 2012 00:00:00 +0000</pubDate>
      <author>ozana@omdesign.cz (Roman Ožana)</author>
      <guid>http://blog.omdesign.cz/wysiwyg-pro-popis-u%C5%BEivatele-ve-wordpress/</guid>
      <description>

&lt;h1 id=&#34;wysiwyg-pro-popis-uživatele-ve-wordpress&#34;&gt;WYSIWYG pro popis uživatele ve Wordpress&lt;/h1&gt;

&lt;p&gt;Následující kratičký kód zobrazí #WYSIWYG editor u popisu autora u uživatelského profilu: Kód stačí přidat do &lt;code&gt;function.php&lt;/code&gt; ve vašem template:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;?php
/**
 * WYSIWYG pro uzivatelsky profil Wordpress
 *
 * @author Roman Ozana &amp;lt;ozana@omdesign.cz&amp;gt;
 */
class CustomUserProfile {

  /** @var array */
  private $tinymceOptions = array(
    &#39;teeny&#39; =&amp;gt; true,
    &#39;quicktags&#39; =&amp;gt; false,
    &#39;media_buttons&#39; =&amp;gt; false, &#39;textarea_rows&#39; =&amp;gt; 8,
    &#39;wpautop&#39; =&amp;gt; false,
    &#39;tinymce&#39; =&amp;gt; array(
      &#39;theme_advanced_buttons1&#39; =&amp;gt; &#39;p, bold, italic, ul, |,link,unlink,code&#39;,
      &#39;theme_advanced_buttons2&#39; =&amp;gt; &#39;&#39;,
      &#39;theme_advanced_buttons3&#39; =&amp;gt; &#39;&#39;,
      &#39;theme_advanced_buttons4&#39; =&amp;gt; &#39;&#39;,
    ),
  );

  public function __construct() {
    add_action(&#39;show_user_profile&#39;, array($this, &#39;initDescriptionWysywig&#39;));
    add_action(&#39;edit_user_profile&#39;, array($this, &#39;initDescriptionWysywig&#39;));
  }

  /**
   * Wysywig editor take pro description
   *
   * @param $options
   */
  public function initDescriptionWysywig($options) {
    if ( ! class_exists(&#39;_WP_Editors&#39; ) )
      require_once( ABSPATH . WPINC . &#39;/class-wp-editor.php&#39; );

    $options = _WP_Editors::parse_settings(&#39;description&#39;, $this-&amp;gt;tinymceOptions);
    _WP_Editors::editor_settings(&#39;description&#39;, $options);
    wp_print_styles(&#39;editor-buttons&#39;);
  }

}
new CustomUserProfile();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;#wordpress #php&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Hash tags pro Wordpress</title>
      <link>http://blog.omdesign.cz/wordpress/hash-tags-pro-wordpress/</link>
      <pubDate>Sat, 15 Sep 2012 00:00:00 +0000</pubDate>
      <author>ozana@omdesign.cz (Roman Ožana)</author>
      <guid>http://blog.omdesign.cz/wordpress/hash-tags-pro-wordpress/</guid>
      <description>

&lt;h1 id=&#34;hash-tags-pro-wordpress&#34;&gt;Hash tags pro Wordpress&lt;/h1&gt;

&lt;p&gt;Napsal jsem velmi jednoduchý plugin, který přidává do Wordpress podporu pro hash tagy:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;?php
/*
Plugin Name: Hashs
Description: Twitter like hash for Wordpress
Version: 1.0
Author: Roman Ozana &amp;lt;ozana@omdesign.cz&amp;gt;
Author URI: http://www.omdesign.cz/
*/
class Hashs {

  const PATTERN = &#39;/\B#([^\s\W#]+)/i&#39;;

  /**
   * @param string $content
   * @return string mixed
   */
  public static function processContent($content) {
    return preg_replace(Hashs::PATTERN, &#39;&amp;lt;a href=&amp;quot;&#39; . get_home_url(null, &#39;/tag/$1&#39;) . &#39;&amp;quot; class=&amp;quot;tag&amp;quot;&amp;gt;#$1&amp;lt;/a&amp;gt; &#39;, $content);
  }

  /**
   * Auto hash tags
   *
   * @param $post_id
   * @return bool
   */
  public static function addAutoTags($post_id) {
    $post = get_post($post_id);
    preg_match_all(Hashs::PATTERN, $post-&amp;gt;post_content, $matches);
    if (!isset($matches[1])) return;
    wp_set_object_terms($post_id, $matches[1], &#39;post_tag&#39;, false); // replace
  }
}

add_filter(&#39;the_content&#39;, array(&#39;Hashs&#39;, &#39;processContent&#39;), 1);
add_action(&#39;save_post&#39;, array(&#39;Hashs&#39;, &#39;addAutoTags&#39;));
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Povšimněte si zejména řádku  &lt;code&gt;wp_set_object_terms($post_id, $matches[1], &#39;post_tag&#39;, false);&lt;/code&gt;
ten totiž ukládá nalezené tagy k postu. Pokud je poslední hodnota &lt;code&gt;true&lt;/code&gt;,
provede append (přidání ke stávajícím tagům). Pokud je &lt;code&gt;false&lt;/code&gt;, provede
nahrazení všech tagů u postu nalezenými hashtagy.&lt;/p&gt;

&lt;p&gt;Zdrojový kód ke stažení zde: &lt;a href=&#34;https://bitbucket.org/OzzyCzech/omhashtag&#34;&gt;https://bitbucket.org/OzzyCzech/omhashtag&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Odstranění odkazů z admin menu Wordpress</title>
      <link>http://blog.omdesign.cz/wordpress/odstraneni-odkazu-z-admin-menu-wordpress/</link>
      <pubDate>Sun, 11 Sep 2011 00:00:00 +0000</pubDate>
      <author>ozana@omdesign.cz (Roman Ožana)</author>
      <guid>http://blog.omdesign.cz/wordpress/odstraneni-odkazu-z-admin-menu-wordpress/</guid>
      <description>

&lt;h1 id=&#34;odstranění-odkazů-z-admin-menu-wordpress&#34;&gt;Odstranění odkazů z admin menu Wordpress&lt;/h1&gt;

&lt;p&gt;Pro &lt;a href=&#34;http://codex.wordpress.org/Links_Manager&#34;&gt;manažer odkazů&lt;/a&gt; #wordpress jsem nenašel nikdy &lt;strong&gt;smysluplné využití&lt;/strong&gt;. Proč ho rovnou z menu neodstranit? Stejně tam jen zavazí:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;add_action(&#39;admin_menu&#39;, function(){
  remove_menu_page(&#39;link-manager.php&#39;);
});
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Obdobně je možné odstranit cokoliv dalšího např. &lt;code&gt;remove_menu_page(&#39;edit-comments.php&#39;);&lt;/code&gt; - odstraní odkaz na komentáře.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Zvýraznění právě hledaných slov ve Wordpress</title>
      <link>http://blog.omdesign.cz/wordpress/zvyrazneni-prave-hledanych-slov-ve-wordpress/</link>
      <pubDate>Mon, 15 Nov 2010 00:00:00 +0000</pubDate>
      <author>ozana@omdesign.cz (Roman Ožana)</author>
      <guid>http://blog.omdesign.cz/wordpress/zvyrazneni-prave-hledanych-slov-ve-wordpress/</guid>
      <description>

&lt;h1 id=&#34;zvýraznění-právě-hledaných-slov-ve-wordpress&#34;&gt;Zvýraznění právě hledaných slov ve Wordpress&lt;/h1&gt;

&lt;p&gt;Několik následujících řádků kódu &lt;strong&gt;obalí&lt;/strong&gt; všechna právě vyhledávaná &lt;strong&gt;klíčová slova&lt;/strong&gt; do značky STRONG (class search-keyword). Kód je možné vložit do &lt;em&gt;function.php&lt;/em&gt; ve Vašem template. Nebo jej můžete vložit rovnou do &lt;em&gt;search.php&lt;/em&gt; někde těsně za volání funkce get_header(). Předpokladem samozřejmě je, že využíváte standardních vyhledávacích funkcí &lt;a href=&#34;http://codex.wordpress.org/Function_Reference/get_search_form&#34;&gt;Wordpress&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;function omSearchHeighlight($text)
{
$keys = explode(&amp;quot; &amp;quot;, get_search_query());
$text = preg_replace(&#39;/(&#39;.implode(&#39;|&#39;, $keys) .&#39;)/iu&#39;, &#39;&amp;lt;strong class=&amp;quot;search-keyword&amp;quot;&amp;gt;\0&amp;lt;/strong&amp;gt;&#39;, $text);
return $text;
}

add_filter(&#39;the_title&#39;,&#39;omSearchHeighlight&#39;);
add_filter(&#39;the_content&#39;,&#39;omSearchHeighlight&#39;);
add_filter(&#39;the_excerpt&#39;,&#39;omSearchHeighlight&#39;);

// nezapomeňte strong element nastylovat např.
// strong.search-keyword {background: #f3ff0f!important; color:#000!important;}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Výsledkem je malé, ale užitečné, vylepšení výsledků vyhledávání, které Vás navíc nestojí téměř žádnou námahu. Ještě malá poznámka na závěr: Kód nedbá na velikost písmen.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>